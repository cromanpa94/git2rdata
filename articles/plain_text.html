<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started Storing Dataframes as Plain Text • git2rdata</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting Started Storing Dataframes as Plain Text">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">git2rdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../news/index.html">NEWS</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/plain_text.html">Getting started storing dataframes as plain text</a>
    </li>
    <li>
      <a href="../articles/version_control.html">Storing dataframes under version control</a>
    </li>
    <li>
      <a href="../articles/workflow.html">Potential workflow</a>
    </li>
    <li>
      <a href="../articles/efficiency.html">Efficiency</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../CONTRIBUTING.html">Contributing</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/git2rdata">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/INBOVlaanderen">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.facebook.com/pg/INBOVlaanderen">
    <span class="fa fa-facebook fg-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting Started Storing Dataframes as Plain Text</h1>
                        <h4 class="author">Thierry Onkelinx</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/git2rdata/blob/master/vignettes/plain_text.Rmd"><code>vignettes/plain_text.Rmd</code></a></small>
      <div class="hidden name"><code>plain_text.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette motivates why we wrote <code>git2rdata</code> and illustrates how you can use it to store dataframes as plain text files.</p>
<div id="maintaining-variable-classes" class="section level3">
<h3 class="hasAnchor">
<a href="#maintaining-variable-classes" class="anchor"></a>Maintaining Variable Classes</h3>
<p>R has different options to store dataframes as plain text files from R. Base R has <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code> and its companions like <code><a href="https://rdrr.io/r/utils/write.table.html">write.csv()</a></code>. Some other options are <code>data.table::fwrite()</code>, <code>readr::write_delim()</code>, <code>readr::write_csv()</code> and <code>readr::write_tsv()</code>. Each of them writes a dataframe as a plain text file by converting all variables into characters. After reading the file, they revert this conversion. The distinction between <code>character</code> and <code>factor</code> gets lost in translation. <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> converts by default all strings to factors, <code>readr::read_csv()</code> keeps by default all strings as character. These functions cannot recover the factor levels. These functions determine factor levels based on the observed levels in the plain text file. Hence factor levels without observations will disappear. The order of the factor levels is also determined by the available levels in the plain text file, which can be different from the original order.</p>
<p>The <code><a href="../reference/write_vc.html">write_vc()</a></code> and <code><a href="../reference/read_vc.html">read_vc()</a></code> functions from <code>git2rdata</code> keep track of the class of each variable and, in case of a factor, also of the factor levels and their order. Hence this function pair preserves the information content of the dataframe. The <code>vc</code> suffix stands for <strong>v</strong>ersion <strong>c</strong>ontrol as these functions use their full capacity in combination with a version control system.</p>
</div>
</div>
<div id="efficiency-relative-to-storage-and-time" class="section level2">
<h2 class="hasAnchor">
<a href="#efficiency-relative-to-storage-and-time" class="anchor"></a>Efficiency Relative to Storage and Time</h2>
<div id="optimizing-file-storage" class="section level3">
<h3 class="hasAnchor">
<a href="#optimizing-file-storage" class="anchor"></a>Optimizing File Storage</h3>
<p>Plain text files require more disk space than binary files. This is the price we have to pay for a readable file format. The default option of <code><a href="../reference/write_vc.html">write_vc()</a></code> is to create file as compact as possible. Since we use a tab delimited file format, we can omit quotes around character variables. This saves 2 bytes per row for each character variable. <code>write_vc</code> add quotes automatically in the exceptional cases when we needed them, e.g. to store a string that contains tab or newline characters. We don’t add quotes to row-variable combinations where we don’t need them.</p>
<p>Since we store the class of each variable, we can further reduce the file size by following rules:</p>
<ul>
<li>Store a <code>logical</code> as 0 (FALSE), 1 (TRUE) or NA to the data.</li>
<li>Store a <code>factor</code> as its indices in the data. Store the index, labels of levels and their order in the metadata.</li>
<li>Store a <code>POSIXct</code> as a numeric to the data. Store the class and the origin in the metadata. Store and return timestamps as UTC.</li>
<li>Store a <code>Date</code> as an integer to the data. Store the class and the origin in the metadata.</li>
</ul>
<p>Storing the factors, POSIXct and Date as their index, makes them less user readable. The user can turn off this optimization when user readability is more important than file size.</p>
</div>
<div id="optimized-for-version-control" class="section level3">
<h3 class="hasAnchor">
<a href="#optimized-for-version-control" class="anchor"></a>Optimized for Version Control</h3>
<p>Another main goal of <code>git2rdata</code> is to optimise the storage of the plain text files under version control. <code><a href="../reference/write_vc.html">write_vc()</a></code> and <code><a href="../reference/read_vc.html">read_vc()</a></code> has methods for interacting with <a href="https://git-scm.com/">git</a> repositories using the <code>git2r</code> framework. Users who want to use git without <code>git2r</code> or use a different version control system (e.g. <a href="https://subversion.apache.org/">Subversion</a>, <a href="https://www.mercurial-scm.org/">Mercurial</a>), still can use <code>git2rdata</code> to write the files to disk and uses their preferred workflow on version control.</p>
<p>Hence, <code><a href="../reference/write_vc.html">write_vc()</a></code> will always perform checks to look for changes which potentially lead to large diffs. More details on this in <code><a href="../articles/version_control.html">vignette("version_control", package = "git2rdata")</a></code>. Some problems will always yield a warning. Other problems will yield an error by default. The user can turn these errors into warnings by setting the <code>strict = FALSE</code> argument.</p>
<p>As this vignette ignores the part on version control, we will always use <code><a href="../reference/write_vc.html">write_vc(strict = FALSE)</a></code> and hide the warnings to improve the readability.</p>
</div>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic Usage</h2>
<p>Let’s start by setting up the environment. We need a directory to store the data and a dataframe to store.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Create a directory in tempdir</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>(<span class="dt">pattern =</span> <span class="st">"git2r-"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span>(path)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># Create dummy data</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">20190222</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(LETTERS),</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">    <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="ot">NA</span>), <span class="dv">26</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">    <span class="dt">levels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">  ),</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  <span class="dt">z =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="ot">NA</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>),</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  <span class="dt">abc =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">25</span>), <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  <span class="dt">def =</span> <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">NA</span>), <span class="dv">26</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  <span class="dt">timestamp =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">    <span class="kw"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span>(<span class="st">"2018-01-01"</span>),</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">    <span class="kw"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span>(<span class="st">"2019-01-01"</span>),</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">    <span class="dt">length =</span> <span class="dv">26</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">  ),</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21">)</a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(x)</a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt; 'data.frame':    26 obs. of  6 variables:</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt;  $ x        : chr  "V" "U" "Z" "W" ...</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt;  $ y        : Factor w/ 3 levels "a","b","c": 1 2 NA NA 1 NA 2 1 NA 1 ...</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt;  $ z        : int  NA 1 2 3 4 5 6 7 8 9 ...</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt;  $ abc      : num  -0.382 -0.42 -0.917 0.387 -0.992 ...</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt;  $ def      : logi  TRUE FALSE NA FALSE NA NA ...</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt;  $ timestamp: POSIXct, format: "2018-01-01 00:00:00" "2018-01-15 14:24:00" ...</span></a></code></pre></div>
</div>
<div id="storing-optimized" class="section level2">
<h2 class="hasAnchor">
<a href="#storing-optimized" class="anchor"></a>Storing Optimized</h2>
<p>Use <code><a href="../reference/write_vc.html">write_vc()</a></code> to store the dataframe. The <code>root</code> argument refers to the base directory where we store the data. The <code>file</code> argument becomes the base name of the files. The data file gets a <code>.tsv</code> extension, the metadata file a <code>.yml</code> extension. <code>file</code> can include a relative path starting from <code>root</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(git2rdata)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="../reference/write_vc.html">write_vc</a></span>(<span class="dt">x =</span> x, <span class="dt">file =</span> <span class="st">"first_test"</span>, <span class="dt">root =</span> path, <span class="dt">strict =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; 7fed986e0f5c218e3d0a4f0cc434bd87bb1e5f82 f8350dc218051af4bafcd8872d92b1a29cbb4f31 </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;                         "first_test.tsv"                         "first_test.yml"</span></a></code></pre></div>
<p><code><a href="../reference/write_vc.html">write_vc()</a></code> returns a vector of relative paths to the raw data and metadata files. The names of this vector contains the hashes of these files. We can have a look at both files. We’ll display the first 10 rows of the raw data. Notice that the YAML format of the metadata has the benefit of being both human and machine readable.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">print_file &lt;-<span class="st"> </span><span class="cf">function</span>(file, root, <span class="dt">n =</span> <span class="dv">-1</span>) {</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  fn &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(root, file)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span>(fn, <span class="dt">n =</span> n)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(data, <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw">print_file</span>(<span class="st">"first_test.tsv"</span>, path, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; x    y   z   abc def timestamp</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; V    1   NA  -0.382010380419258  1   1514764800</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; U    2   1   -0.420347607856041  0   1516026240</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; Z    NA  2   -0.916731402237418  NA  1517287680</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; W    NA  3   0.387455128525654   0   1518549120</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; L    1   4   -0.992354993526956  NA  1519810560</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; C    NA  5   0.0228713954429028  NA  1521072000</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; R    2   6   -0.947557467717088  1   1522333440</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; S    1   7   -0.16302914628615   NA  1523594880</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; O    NA  8   0.523643352634392   1   1524856320</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="kw">print_file</span>(<span class="st">"first_test.yml"</span>, path)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; ..generic:</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;   git2rdata: 0.2.1</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt;   optimize: yes</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt;   NA string: NA</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt;   hash: f8350dc218051af4bafcd8872d92b1a29cbb4f31</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt;   data_hash: 7fed986e0f5c218e3d0a4f0cc434bd87bb1e5f82</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; x:</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt;   class: character</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; 'y':</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt;   class: factor</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt;   labels:</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt;   - a</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt;   - b</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt;   - c</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt;   index:</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt;   - 1</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt;   - 2</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt;   - 3</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt;   ordered: no</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#&gt; z:</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co">#&gt;   class: integer</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">#&gt; abc:</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="co">#&gt;   class: numeric</span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co">#&gt; def:</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="co">#&gt;   class: logical</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="co">#&gt; timestamp:</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="co">#&gt;   class: POSIXct</span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="co">#&gt;   origin: 1970-01-01 00:00:00</span></a>
<a class="sourceLine" id="cb3-46" data-line-number="46"><span class="co">#&gt;   timezone: UTC</span></a></code></pre></div>
</div>
<div id="storing-verbose" class="section level2">
<h2 class="hasAnchor">
<a href="#storing-verbose" class="anchor"></a>Storing Verbose</h2>
<p>Adding <code>optimize = FALSE</code> to <code><a href="../reference/write_vc.html">write_vc()</a></code> will keep the raw data in a human readable format. The metadata file is slightly different. The most obvious is the <code>optimize: no</code> tag and the different hash. Another difference is the metadata for POSIXct and Date classes. They will no longer have an origin tag but a format tag.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/write_vc.html">write_vc</a></span>(<span class="dt">x =</span> x, <span class="dt">file =</span> <span class="st">"verbose"</span>, <span class="dt">root =</span> path, <span class="dt">optimize =</span> <span class="ot">FALSE</span>, <span class="dt">strict =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; d1a61b91465221b40f7986c2a8da421a2e166c5b 9fc40476f0ba0c4cb4225d5313d56760a6d3b065 </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;                            "verbose.tsv"                            "verbose.yml"</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">print_file</span>(<span class="st">"verbose.tsv"</span>, path, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; x    y   z   abc def timestamp</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; V    a   NA  -0.382010380419258  TRUE    2018-01-01T00:00:00Z</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; U    b   1   -0.420347607856041  FALSE   2018-01-15T14:24:00Z</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; Z    NA  2   -0.916731402237418  NA  2018-01-30T04:48:00Z</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; W    NA  3   0.387455128525654   FALSE   2018-02-13T19:12:00Z</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; L    a   4   -0.992354993526956  NA  2018-02-28T09:36:00Z</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; C    NA  5   0.0228713954429028  NA  2018-03-15T00:00:00Z</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; R    b   6   -0.947557467717088  TRUE    2018-03-29T14:24:00Z</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; S    a   7   -0.16302914628615   NA  2018-04-13T04:48:00Z</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; O    NA  8   0.523643352634392   TRUE    2018-04-27T19:12:00Z</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="kw">print_file</span>(<span class="st">"verbose.yml"</span>, path)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; ..generic:</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt;   git2rdata: 0.2.1</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;   optimize: no</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;   NA string: NA</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;   hash: 9fc40476f0ba0c4cb4225d5313d56760a6d3b065</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt;   data_hash: d1a61b91465221b40f7986c2a8da421a2e166c5b</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; x:</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt;   class: character</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; 'y':</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt;   class: factor</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt;   labels:</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt;   - a</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt;   - b</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt;   - c</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt;   index:</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="co">#&gt;   - 1</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co">#&gt;   - 2</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="co">#&gt;   - 3</span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="co">#&gt;   ordered: no</span></a>
<a class="sourceLine" id="cb5-32" data-line-number="32"><span class="co">#&gt; z:</span></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="co">#&gt;   class: integer</span></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="co">#&gt; abc:</span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="co">#&gt;   class: numeric</span></a>
<a class="sourceLine" id="cb5-36" data-line-number="36"><span class="co">#&gt; def:</span></a>
<a class="sourceLine" id="cb5-37" data-line-number="37"><span class="co">#&gt;   class: logical</span></a>
<a class="sourceLine" id="cb5-38" data-line-number="38"><span class="co">#&gt; timestamp:</span></a>
<a class="sourceLine" id="cb5-39" data-line-number="39"><span class="co">#&gt;   class: POSIXct</span></a>
<a class="sourceLine" id="cb5-40" data-line-number="40"><span class="co">#&gt;   format: '%Y-%m-%dT%H:%M:%SZ'</span></a>
<a class="sourceLine" id="cb5-41" data-line-number="41"><span class="co">#&gt;   timezone: UTC</span></a></code></pre></div>
</div>
<div id="efficiency-relative-to-file-storage" class="section level2">
<h2 class="hasAnchor">
<a href="#efficiency-relative-to-file-storage" class="anchor"></a>Efficiency Relative to File Storage</h2>
<p>Storing dataframes optimized or verbose has an impact on the required file size. The <a href="efficiency.html#on-a-file-system">efficiency</a> vignette give a comparison.</p>
</div>
<div id="reading-data" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-data" class="anchor"></a>Reading Data</h2>
<p>You retrieve the data with <code><a href="../reference/read_vc.html">read_vc()</a></code>. This function will reinstate the variables to their original state.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_vc.html">read_vc</a></span>(<span class="dt">file =</span> <span class="st">"first_test"</span>, <span class="dt">root =</span> path)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span>(x, y, <span class="dt">check.attributes =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">y2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_vc.html">read_vc</a></span>(<span class="dt">file =</span> <span class="st">"verbose"</span>, <span class="dt">root =</span> path)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span>(x, y2, <span class="dt">check.attributes =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p><code><a href="../reference/read_vc.html">read_vc()</a></code> requires the meta data. It cannot handle dataframe not stored by <code><a href="../reference/write_vc.html">write_vc()</a></code>.</p>
</div>
<div id="missing-values" class="section level2">
<h2 class="hasAnchor">
<a href="#missing-values" class="anchor"></a>Missing Values</h2>
<p><code><a href="../reference/write_vc.html">write_vc()</a></code> has an <code>na</code> argument which specifies the string which to use for missing values. Because we avoid using quotes, this string must be different from any character value in the data. This includes factor labels with verbose data storage. <code><a href="../reference/write_vc.html">write_vc()</a></code> checks this and will always return an error, even with <code>strict = FALSE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/write_vc.html">write_vc</a></span>(x, <span class="st">"custom_na"</span>, path, <span class="dt">strict =</span> <span class="ot">FALSE</span>, <span class="dt">na =</span> <span class="st">"X"</span>, <span class="dt">optimize =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; Error: one of the strings matches the NA string ('X')</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; Please use a different NA string or consider using a factor.</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="../reference/write_vc.html">write_vc</a></span>(x, <span class="st">"custom_na"</span>, path, <span class="dt">strict =</span> <span class="ot">FALSE</span>, <span class="dt">na =</span> <span class="st">"b"</span>, <span class="dt">optimize =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; Error: one of the levels matches the NA string ('b').</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; Please use a different NA string or use optimize = TRUE</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw"><a href="../reference/write_vc.html">write_vc</a></span>(x, <span class="st">"custom_na"</span>, path, <span class="dt">strict =</span> <span class="ot">FALSE</span>, <span class="dt">na =</span> <span class="st">"X"</span>)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; Error: one of the strings matches the NA string ('X')</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; Please use a different NA string or consider using a factor.</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="kw"><a href="../reference/write_vc.html">write_vc</a></span>(x, <span class="st">"custom_na"</span>, path, <span class="dt">strict =</span> <span class="ot">FALSE</span>, <span class="dt">na =</span> <span class="st">"b"</span>)</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; 5415c0176d1c25fc1ac08763ae9271f6306eccc5 3c028ddbb9efabc8c85a396b2db1f4f1c8d9461d </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;                          "custom_na.tsv"                          "custom_na.yml"</span></a></code></pre></div>
<p>Please note that <code><a href="../reference/write_vc.html">write_vc()</a></code> uses the same NA string for the entire dataset, thus for every variable.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">print_file</span>(<span class="st">"custom_na.tsv"</span>, path, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; x    y   z   abc def timestamp</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; V    1   b   -0.382010380419258  1   1514764800</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; U    2   1   -0.420347607856041  0   1516026240</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; Z    b   2   -0.916731402237418  b   1517287680</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; W    b   3   0.387455128525654   0   1518549120</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; L    1   4   -0.992354993526956  b   1519810560</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; C    b   5   0.0228713954429028  b   1521072000</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; R    2   6   -0.947557467717088  1   1522333440</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; S    1   7   -0.16302914628615   b   1523594880</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; O    b   8   0.523643352634392   1   1524856320</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="kw">print_file</span>(<span class="st">"custom_na.yml"</span>, path, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; ..generic:</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;   git2rdata: 0.2.1</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;   optimize: yes</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;   NA string: b</span></a></code></pre></div>
<p>The default string for missing values is <code>"NA"</code>. We recommend to keep this default, as long as the dataset permits it. A first good alternative is an empty string (<code>""</code>). If that won’t work either, you’ll have to use your imagination. Try to keep it short, clear and robust<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/write_vc.html">write_vc</a></span>(x, <span class="st">"custom_na"</span>, path, <span class="dt">strict =</span> <span class="ot">FALSE</span>, <span class="dt">na =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; dfaf9f13491b30a88b7e37dabd9f9c87225fbba0 d2b145b74dbe6bd1d7883a62f2549c124988ec63 </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt;                          "custom_na.tsv"                          "custom_na.yml"</span></a></code></pre></div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>robust in the sense that you won’t need to change it later<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#efficiency-relative-to-storage-and-time">Efficiency Relative to Storage and Time</a></li>
      <li><a href="#basic-usage">Basic Usage</a></li>
      <li><a href="#storing-optimized">Storing Optimized</a></li>
      <li><a href="#storing-verbose">Storing Verbose</a></li>
      <li><a href="#efficiency-relative-to-file-storage">Efficiency Relative to File Storage</a></li>
      <li><a href="#reading-data">Reading Data</a></li>
      <li><a href="#missing-values">Missing Values</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.muscardinus.be">Thierry Onkelinx</a>, <a href="https://www.inbo.be/en"><img src="https://ropensci.github.io/git2rdata/reference/figures/logo_en.png" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
